<!DOCTYPE html>
<html>
<head>
  <title>Convite MeuApp</title>
</head>
<body>
  <h2>Seu convite est√° pronto!</h2>
  <p>Convite de: <strong id="ref"></strong></p>
  <button onclick="copiarConvite()">Copiar convite e baixar app</button>

  <script>
    async function copiarConvite() {
      const ref = new URLSearchParams(window.location.search).get("ref") || "DESCONHECIDO";
      document.getElementById("ref").textContent = ref;

      const dados = {
        app: "MeuApp",
        codigo: ref,
        timestamp: new Date().toISOString()
      };

      const texto = JSON.stringify(dados, null, 2);

      try {
        await navigator.clipboard.writeText(texto);
        alert("Convite copiado com sucesso!");

        // Redirecionar para o APK
        window.location.href = "https://meuapp.com/downloads/meuapp.apk";
      } catch (err) {
        alert("Erro ao copiar convite: " + err);
      }
    }
  </script>
</body>
</html>
